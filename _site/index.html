<!DOCTYPE html>
<html>
  <head>
    <title>Postal - Create emails using ASP.NET MVC views</title>
    <link href="bootstrap.min.css" rel="stylesheet" type="text/css" />
    <link href="//netdna.bootstrapcdn.com/font-awesome/4.0.3/css/font-awesome.css" rel="stylesheet" />
    <link href="syntax.css" rel="stylesheet"/>
    <link href="site.css" rel="stylesheet"/>
    <meta name="description" content="Create emails using ASP.NET MVC views" />
  </head>
  <body>
    <header>
      <div class="container">
        <h1>Postal</h1>
        <p>Create email using ASP.NET MVC views</p>
      </div>
    </header>
    <div class="container">
        <div class="row">
    <div class="col-md-6">
      <h2>Install</h2>
      <p>Install Postal into your ASP.NET web application using Nuget.</p>
                <pre>PM&gt; Install-Package Postal</pre>

      </div>
      <div class="col-md-6">
        <h2>Open source</h2>
        <p>MIT License</p>
        <a href="https://github.com/andrewdavey/postal" class="btn btn-default">
          <i class="fa fa-github"></i>
          GitHub
        </a>
        <a href="#docs" class="btn btn-default">
          <i class="fa fa-info-circle"></i>
          Documentation
        </a>
        <a href="#video" class="btn btn-default">
          <i class="fa fa-play"></i>
          Video
        </a>
        <a href="https://twitter.com/intent/tweet?text=http%3A%2F%2Faboutcode.net%2Fpostal%2F+Postal+-+Create+emails+from+ASP.NET+MVC+views" target="_blank" class="btn btn-default">
          <i class="fa fa-twitter"></i>
          Tweet
        </a>
      </div>
    </div>
    <div class="row">
      <div class="col-md-6">
        <h2>Getting started</h2>
        <p>Use Postal in your controller action method.</p>
      </div>
    </div>
    <div class="row">
      <div class="col-md-6">
        <div class="highlight"><pre><code class="csharp"><span class="k">using</span> <span class="nn">Postal</span><span class="p">;</span>

<span class="k">public</span> <span class="k">class</span> <span class="nc">HomeController</span> <span class="p">:</span> <span class="n">Controller</span>
<span class="p">{</span>
    <span class="k">public</span> <span class="n">ActionResult</span> <span class="nf">Index</span><span class="p">()</span>
    <span class="p">{</span>
        <span class="kt">dynamic</span> <span class="n">email</span> <span class="p">=</span> <span class="k">new</span> <span class="n">Email</span><span class="p">(</span><span class="s">&quot;Example&quot;</span><span class="p">);</span>
        <span class="n">email</span><span class="p">.</span><span class="n">To</span> <span class="p">=</span> <span class="s">&quot;webninja@example.com&quot;</span><span class="p">;</span>
        <span class="n">email</span><span class="p">.</span><span class="n">FunnyLink</span> <span class="p">=</span> <span class="n">DB</span><span class="p">.</span><span class="n">GetRandomLolcatLink</span><span class="p">();</span>
        <span class="n">email</span><span class="p">.</span><span class="n">Send</span><span class="p">();</span>
        <span class="k">return</span> <span class="nf">View</span><span class="p">();</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
      </div>
      <div class="col-md-6">
        <p>
        Create an <code>Email</code>, passing it the name of the view to use for the email.
        </p>
        <p>
        Using dynamic means we can nicely assign some data to use in the view.
        It's also possible to create a <a href="/strongly-typed-emails.html">strongly-typed</a> email class.
        </p>
        <p>
        Calling <code>Send()</code> will send the email using the .NET Framework's
        <code>SmtpClient</code>.
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-md-6">
        <p>Postal will find the email view at <code>Views\Emails\Example.cshtml</code>:</p>
      </div>
    </div>
    <div class="row">
      <div class="col-md-6">
        <pre>To: @ViewBag.To
From: lolcats@website.com
Subject: Important Message

Hello,
You wanted important web links right?
Check out this: @ViewBag.FunnyLink

&lt;3</pre>
      </div>
      <div class="col-md-6">
        <p>
        The email view specifies the headers and body content.
        </p>
        <p>
        The <code>ViewBag</code> contains any data you assigned to the <code>Email</code> object.
        </p>
        <p>
        Postal can work with any ASP.NET MVC view engine.
        </p>
      </div>
    </div>

    <div class="row">
      <div class="col-md-12">
        <a id="docs"></a>
        <h2>Documentation</h2>
        <ul class="doc-links">
          
          <li>
            <h3>SMTP Configuration</h3>
            <p>
              <p>Postal uses <code>SmtpClient</code>, which can be configured in <code>Web.config</code>.</p>
            </p>
            <p>
              <a href="/smtp-config.html">Learn more&hellip;</a>
            </p>
          </li>
          
          <li>
            <h3>Strongly-typed Emails</h3>
            <p>
              <p>Not everyone likes using dynamic objects. Postal lets you strongly type your email data if you need to.</p>
            </p>
            <p>
              <a href="/strongly-typed-emails.html">Learn more&hellip;</a>
            </p>
          </li>
          
          <li>
            <h3>Unit Testing</h3>
            <p>
              <p>Verify that your code would send emails, without actually sending them.</p>
            </p>
            <p>
              <a href="/unit-testing.html">Learn more&hellip;</a>
            </p>
          </li>
          
          <li>
            <h3>Attachments</h3>
            <p>
              <p>Attach files to your emails.</p>
            </p>
            <p>
              <a href="/attachments.html">Learn more&hellip;</a>
            </p>
          </li>
          
          <li>
            <h3>HTML & Plain-text Emails</h3>
            <p>
              <p>Use multiple views to define the HTML and plain-text content of your emails.</p>
            </p>
            <p>
              <a href="/multi-part.html">Learn more&hellip;</a>
            </p>
          </li>
          
          <li>
            <h3>Embedding Images</h3>
            <p>
              <p>Embed images in your emails. Postal will handle the multi-part stuff for you.</p>
            </p>
            <p>
              <a href="/embedding-images.html">Learn more&hellip;</a>
            </p>
          </li>
          
          <li>
            <h3>Postal Outside of ASP.NET</h3>
            <p>
              <p>Send email from command line applications and Windows services.</p>
            </p>
            <p>
              <a href="/outside-aspnet.html">Learn more&hellip;</a>
            </p>
          </li>
          
          <li>
            <h3>Email Headers</h3>
            <p>
              <p>Set email headers, such as CC, BCC, Reply-To, etc.</p>
            </p>
            <p>
              <a href="/email-headers.html">Learn more&hellip;</a>
            </p>
          </li>
          
          <li>
            <h3>Creating Email Without Sending</h3>
            <p>
              <p>Instead of directly sending email, Postal can just create a <code>System.Net.MailMessage</code> object for you.</p>
            </p>
            <p>
              <a href="/create-mail-message.html">Learn more&hellip;</a>
            </p>
          </li>
          
        </ul>
      </div>
    </div>

    <div class="row">
      <div class="col-md-12">
        <a id="video"></a>
        <h2>Video presentation from mvcConf 2</h2>
        <p>
        <video poster="http://ak.channel9.msdn.com/ch9/98F1/68E86138-6D6B-41E0-8B1B-9E89016998F1/mvcconfandrewdavey_512_ch9.jpg" controls style="width: 100%">
        <source src="http://ak.channel9.msdn.com/ch9/98F1/68E86138-6D6B-41E0-8B1B-9E89016998F1/mvcconfandrewdavey_high_ch9.mp4" type="video/mp4" />
        </video>
        </p>

        <h2>Credits</h2>
        <p>
        Postal was created by Andrew Davey.
        Read his blog <a href="http://aboutcode.net/">aboutcode.net</a>
        or follow him <a href="https://twitter.com/andrewdavey">@andrewdavey</a>
        </p>
        <p>
        Photo Credit: <a href="http://www.flickr.com/photos/32466163@N00/697806617/">....Tim</a> via <a href="http://compfight.com">Compfight</a> <a href="http://creativecommons.org/licenses/by-nc-nd/2.0/">cc</a>
        </p>
      </div>
    </div>

  <!--
  <div>
    <div class="row">
      <div class="col-md-6">
        <h2>Strongly-typed emails</h2>
        <p>
        Not everyone likes using dynamic objects.
        Postal lets you strongly type your email data if you need to.
        </p>
        <p>Step 1 - Define a class that inherits from Email</p>
        <pre>namespace App.Models {
  public class ExampleEmail : Email {
    public string To { get; set; }
    public string Message { get; set; }
  }
}</pre>
        <p>Step 2 - Use that class!</p>
        <pre>public void Send() {
  var email = new ExampleEmail {
    To = "hello@world.com",
    Message = "Strong typed message"
  };
  email.Send();
}</pre>
        <p>
        Step 3 - Create a view that uses your model.
        The name of the view is based on the class name.
        So <code>ExampleEmail</code> requires a view called <code>Example.cshtml</code>.
        </p>
        <pre>
@model App.Models.ExampleEmail
To: @Model.To
From: postal@example.com
Subject: Example

Hello,
@Model.Message
Thanks!</pre>
        </div>
      </div>
      <div class="row">
        <div class="col-md-6">
          <h2>Unit Testing</h2>
          <p>
          When unit testing code that uses Postal, you may want to verify
          that an email would be sent, without actual sending it.
          </p>
          <p>
          Postal provides an interface <code>IEmailService</code> and an 
          implementation, <code>EmailService</code>, which actually sends
          email.
          </p>
          <p>
          Assuming you use some kind of IoC container, configure it to inject
          an <code>IEmailService</code> into your controller.
          </p>
          <p>
          Then use the service to send email objects (instead of calling <code>Email.Send()</code>).
          </p>
          <pre>public class ExampleController : Controller 
{
    public ExampleController(IEmailService emailService)
    {
        this.emailService = emailService;
    }

    readonly IEmailService emailService;

    public ActionResult Index()
    {
        dynamic email = new Email("Example");
        // ...
        emailService.Send(email);
        return View();
    }
}</pre>
          <p>
          Test this controller by creating a mock of the <code>IEmailService</code> interface.
          </p>
          <p>
          Here's an example using <a href="https://github.com/FakeItEasy/FakeItEasy">FakeItEasy</a>.
          </p>
          <pre>[Test]
public void ItSendsEmail()
{
    var emailService = A.Fake&lt;IEmailService&gt;();
    var controller = new ExampleController(emailService);
    controller.Index();
    A.CallTo(() => emailService.Send(A&lt;Email&gt;._))
     .MustHaveHappened();
}</pre>
          </div>
        </div>
      </div>-->

    </div>

    <script type="text/javascript">
      var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
      document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
    </script>
    <script type="text/javascript">
      try {
        var pageTracker = _gat._getTracker("UA-19461164-1");
        pageTracker._trackPageview();
      } catch(err) {}
    </script>
  </body>
</html>

